# This is a basic workflow to help you get started with Actions
name: Sigma Github-hosted SARIF Upload
# Controls when the action will run. 

on:
  # Triggers the workflow on push or pull request events but only for the master branch
  #push:
  #  branches: [ main ]
  pull_request:
    branches: [ main ]
  # Allows you to run this workflow manually from the Actions tab\
  #workflow_dispatch:

jobs:
  sigma_github_hosted_sarif_upload_steps:
    runs-on: ubuntu-latest
    container:
      image: blesseed/sigmatesting:2021.9.1
      credentials:
        username: ${{ secrets.USERNAME }}
        password: ${{ secrets.DOCkPASS }}
    steps:
      - name: Check out the repo
        uses: actions/checkout@v2

      - name: Sigma analysis
        run: sigma analyze --format github .          
 
      - name: Upload SARIF file
        uses: github/codeql-action/upload-sarif@v1
        with:
          sarif_file: sigma-results.json
